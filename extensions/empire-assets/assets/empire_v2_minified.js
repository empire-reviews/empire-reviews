function initCarousel(){console.log("üé† Empire Carousel: Initializing...");document.querySelectorAll(".empire-carousel-container").forEach(async e=>{const t=e.querySelector(".empire-carousel-track"),i=parseInt(e.dataset.desktopCols),n=parseInt(e.dataset.mobileCols),r=parseInt(e.dataset.gap),a=e.dataset.style,o=e.dataset.radius+"px",s=e.dataset.bg,d=e.dataset.text,l="glass"===a;e.style.setProperty("--gap",r+"px"),e.style.setProperty("--desk-cols",i),e.style.setProperty("--mob-cols",n);try{const i=await fetch("/apps/empire-reviews/api/reviews?minRating=5&limit=10"),n=await i.json();if(n.reviews&&n.reviews.length>0){t.innerHTML="",n.reviews.forEach(i=>{const n=document.createElement("div");n.className=`empire-carousel-card ${a}`,n.style.borderRadius=o,n.style.background=l?"rgba(255, 255, 255, 0.7)":s,l&&(n.style.backdropFilter="blur(12px)"),n.style.color=d,n.style.padding="24px",n.style.minWidth="calc((100% / var(--active-cols)) - var(--gap))",n.style.flexShrink="0",n.style.scrollSnapAlign="start",n.innerHTML=`\n                         <div style="font-size:1.2rem; color:#fbbf24; margin-bottom:12px;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>\n                         <div style="font-size:1rem; line-height:1.5; margin-bottom:16px; display:-webkit-box; -webkit-line-clamp:4; -webkit-box-orient:vertical; overflow:hidden;">"${i.body}"</div>\n                         <div style="display:flex; align-items:center; gap:10px;">\n                             <div style="width:32px; height:32px; background:#f3f4f6; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#111;">${(i.customerName||"A").charAt(0)}</div>\n                             <div>\n                                 <div style="font-weight:700; font-size:0.9rem;">${i.customerName||"Anonymous"}</div>\n                                 ${"true"===e.dataset.verified?'<div style="font-size:0.7rem; opacity:0.7; display:flex; align-items:center; gap:4px;">Verified Buyer <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></div>':""}\n                             </div>\n                         </div>\n                    `,t.appendChild(n)});const i=document.createElement("style");i.textContent="\n                    .empire-carousel-track {\n                        display: flex;\n                        gap: var(--gap);\n                        overflow-x: auto;\n                        scroll-snap-type: x mandatory;\n                        padding-bottom: 20px;\n                        scrollbar-width: none;\n                    }\n                    .empire-carousel-track::-webkit-scrollbar { display: none; }\n                    .empire-carousel-card { \n                        box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); \n                        border: 1px solid rgba(0,0,0,0.05);\n                        transition: transform 0.3s;\n                    }\n                    .empire-carousel-card:hover { transform: translateY(-5px); }\n                    @media(min-width: 768px) { .empire-carousel-container { --active-cols: var(--desk-cols); } }\n                    @media(max-width: 767px) { .empire-carousel-container { --active-cols: var(--mob-cols); } }\n                ",e.appendChild(i)}else t.innerHTML="<div style='text-align:center; opacity:0.5;'>No 5-star reviews found yet.</div>"}catch(e){console.error("Carousel Error:",e)}})}function initFloatingTab(){const e=document.getElementById("empire-floating-tab-config");if(!e)return;console.log("üè∑Ô∏è Empire Tab: Initializing...");const t=document.createElement("div");t.id="empire-floating-btn",t.style.position="fixed",t.style.zIndex="9999",t.style.cursor="pointer",t.style.background=e.dataset.bg,t.style.color=e.dataset.text,t.style.padding="12px 20px",t.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)",t.style.fontWeight="600",t.style.display="flex",t.style.alignItems="center",t.style.gap="8px",t.style.transition="transform 0.2s";const i=e.dataset.position,n=e.dataset.offset+"%";if("left"===i?(t.style.left="0",t.style.top=n,t.style.borderRadius="0 8px 8px 0",t.style.transformOrigin="left center",t.innerHTML=`<span style="writing-mode: vertical-rl; transform: rotate(180deg);">${e.dataset.label}</span>`):"right"===i?(t.style.right="0",t.style.top=n,t.style.borderRadius="8px 0 0 8px",t.style.transformOrigin="right center",t.innerHTML=`<span style="writing-mode: vertical-rl;">${e.dataset.label}</span>`):"bottom-right"===i&&(t.style.right="20px",t.style.bottom="20px",t.style.borderRadius="30px",t.innerHTML=`${"star"===e.dataset.icon?"‚òÖ":""} ${e.dataset.label}`),"true"===e.dataset.pulse){const e=document.createElement("style");e.textContent="@keyframes empire-pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }",document.head.appendChild(e),t.style.animation="empire-pulse 2s infinite"}document.body.appendChild(t),t.addEventListener("click",()=>{alert("Empire Reviews Drawer would open here! (Feature coming in next step)")})}function initMediaGrid(){document.querySelectorAll(".empire-media-grid-container").forEach(async e=>{const t=e.querySelector(".empire-media-grid");try{const i=await fetch("/apps/empire-reviews/api/reviews?limit=12"),n=(await i.json()).reviews;if(n.length>0){t.innerHTML="";const i=e.dataset.cols,r=e.dataset.mobileCols,a=e.dataset.gap;t.style.display="grid",t.style.gridTemplateColumns=`repeat(${r}, 1fr)`,t.style.gap=a+"px";const o=document.createElement("style");o.textContent=`@media(min-width: 768px) { .empire-media-grid { grid-template-columns: repeat(${i}, 1fr) !important; } }`,e.appendChild(o),n.forEach(i=>{const n=document.createElement("div");n.style.aspectRatio="portrait"===e.dataset.aspect?"4/5":"1/1",n.style.background="#f3f4f6",n.style.borderRadius="8px",n.style.overflow="hidden",n.style.position="relative",n.style.cursor="pointer",n.style.backgroundImage=`linear-gradient(135deg, ${getRandomColor()} 0%, #e5e7eb 100%)`;const r=document.createElement("div");r.style.position="absolute",r.style.inset="0",r.style.background=e.dataset.overlay,r.style.opacity="0",r.style.transition="opacity 0.3s",r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.innerHTML='<span style="color:white; font-weight:bold; border:2px solid white; padding:8px 16px;">Shop Now</span>',n.onmouseenter=()=>r.style.opacity=parseFloat(e.dataset.opacity)/100,n.onmouseleave=()=>r.style.opacity="0",n.appendChild(r),t.appendChild(n)})}else t.innerHTML="No media reviews found."}catch(e){console.error("Media Grid Error:",e)}})}function getRandomColor(){const e=["#fca5a5","#fdba74","#fcd34d","#86efac","#93c5fd","#c4b5fd","#f0abfc"];return e[Math.floor(Math.random()*e.length)]}function initReviewWidgets(){console.log("üöÄ Empire Reviews 3.0: Connected & Configurable");document.querySelectorAll(".empire-reviews-widget").forEach(async e=>{const t=e.dataset.productId,i="/apps/empire-reviews",n=`\n            <div class="empire-wrapper">\n                \n            <style>\n                /* RESET & FONTS */\n                .empire-wrapper * { box-sizing: border-box; font-family: 'Inter', system-ui, -apple-system, sans-serif; }\n                \n                /* üèóÔ∏è MAIN LAYOUT CONTAINER */\n                .empire-split-layout {\n                    display: flex;\n                    width: 100%;\n                    max-width: 1200px;\n                    height: 550px; /* Fixed height for 3 reviews */\n                    margin: 2rem auto;\n                    background: var(--empire-sidebar-bg, #fff);\n                    border: 1px solid #e5e7eb;\n                    border-radius: 20px;\n                    overflow: hidden;\n                    border-radius: 20px;\n                    overflow: hidden;\n                    box-shadow: 0 10px 40px -10px rgba(0,0,0,0.08);\n                    position: relative;\n                    z-index: 1; /* Low z-index to stay BEHIND header */\n                    font-size: var(--empire-font-size, 16px);\n                }\n                \n                /* üì± MOBILE RESPONSIVENESS */\n                @media (max-width: 900px) {\n                    .empire-split-layout { flex-direction: column; height: auto; border: none; box-shadow: none; }\n                }\n\n                /* üëà LEFT SIDEBAR */\n                .empire-sidebar {\n                    width: 40%;\n                    height: 100%;\n                    flex-shrink: 0;\n                    background: var(--empire-sidebar-bg, #ffffff);\n                    border-right: 1px solid #f3f4f6;\n                    padding: 3rem;\n                    display: flex;\n                    flex-direction: column;\n                    justify-content: center;\n                    position: relative;\n                    z-index: 2;\n                }\n                @media (max-width: 900px) { .empire-sidebar { width: 100%; height: auto; border-right: none; padding: 2rem; } }\n\n                /* üëâ RIGHT FEED */\n                .empire-feed {\n                    width: 60%;\n                    height: 100%;\n                    flex-grow: 1;\n                    background: var(--empire-feed-bg, #f9fafb);\n                    overflow-y: hidden; /* JS auto-scroll */\n                    padding: 2.5rem;\n                    position: relative;\n                }\n                .empire-feed:hover { overflow-y: auto; }\n                @media (max-width: 900px) { .empire-feed { width: 100%; padding: 1.5rem; overflow: visible; } }\n\n                /* üìä SIDEBAR ELEMENTS */\n                .empire-header-title { font-size: 2em; font-weight: 800; color: var(--empire-text-color, #111); margin-bottom: 0.25em; letter-spacing: -0.5px; }\n                .empire-header-subtitle { color: var(--empire-body-color, #6b7280); font-size: 0.95em; margin-bottom: 1.5em; }\n                \n                .empire-big-rating { font-size: 3.5em; font-weight: 900; line-height: 1; margin-bottom: 0.25em; letter-spacing: -2px; color: var(--empire-text-color, #111); }\n                .empire-total-reviews { color: var(--empire-body-color, #4b5563); font-weight: 500; font-size: 0.9em; margin-bottom: 1.5em; }\n                \n                /* BARS */\n                .empire-bar-row { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }\n                .empire-bar-label { min-width: 30px; font-size: 0.85em; font-weight: 600; color: var(--empire-text-color, #374151); }\n                .empire-bar-bg { flex-grow: 1; height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden; }\n                .empire-bar-fill { height: 100%; background: var(--empire-bar-color, #111); border-radius: 3px; }\n                .empire-bar-count { min-width: 24px; text-align: right; color: #9ca3af; font-size: 0.8em; }\n\n                /* BUTTON */\n                .empire-write-btn {\n                    margin-top: 2rem;\n                    width: 100%;\n                    padding: 1rem;\n                    background: var(--empire-btn-bg, #111);\n                    color: var(--empire-btn-text, #fff);\n                    font-weight: 700;\n                    border-radius: 8px;\n                    border: none;\n                    font-size: 1rem;\n                    cursor: pointer;\n                    transition: all 0.2s;\n                    box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n                }\n                .empire-write-btn:hover { transform: translateY(-1px); opacity: 0.9; }\n\n                /* üìù REVIEW CARDS */\n                .empire-review-card {\n                    background: var(--empire-sidebar-bg, #fff);\n                    border-radius: 16px;\n                    padding: 2rem;\n                    margin-bottom: 1.5rem;\n                    box-shadow: 0 1px 3px rgba(0,0,0,0.05);\n                    border: 1px solid #e5e7eb;\n                }\n                .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }\n                .reviewer-info { display: flex; align-items: center; gap: 1rem; }\n                .avatar { width: 48px; height: 48px; background: #f3f4f6; color: var(--empire-text-color, #111); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; }\n                .username { font-weight: 700; color: var(--empire-text-color, #111); font-size: 1.1em; }\n                .verified-badge { color: var(--empire-verified-color, #16a34a); font-size: 0.8em; font-weight: 600; display: flex; align-items: center; gap: 4px; }\n                \n                .stars-row { color: var(--empire-star-color, #fbbf24); margin-bottom: 0.75em; font-size: 1.25em; }\n                .review-body { font-size: 1.05em; line-height: 1.6; color: var(--empire-body-color, #4b5563); }\n                .review-date { color: #9ca3af; font-size: 0.875em; margin-left: 8px; }\n\n                /* WIZARD INPUTS */\n                .empire-input { width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 10px; font-size: 1rem; }\n                \n                /* 3D STARS */\n                .empire-star-input { display: flex; gap: 15px; font-size: 3.5rem; cursor: pointer; color: #e5e7eb; justify-content: center; margin: 2rem 0; perspective: 1000px; }\n                .empire-star-input span { transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), color 0.2s, filter 0.2s; text-shadow: 0 4px 0 #d1d5db; display: inline-block; }\n                .empire-star-input span:hover { transform: scale(1.2) translateY(-10px); filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.6)); }\n                .empire-star-input span.active { color: var(--empire-star-color, #fbbf24); text-shadow: 0 4px 0 rgba(0,0,0,0.1); transform: scale(1.1) translateY(-5px); }\n\n                /* ANIMATIONS */\n                @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }\n                .fade-in { animation: fadeIn 0.4s ease-out; }\n                \n                /* REPLY BOX */\n                .empire-reply-box { background: var(--empire-feed-bg, #f9fafb); padding: 1rem; border-radius: 8px; margin-top: 1rem; border-left: 3px solid var(--empire-btn-bg, #111); }\n                .empire-reply-header { font-weight: 700; font-size: 0.9em; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 6px; color: var(--empire-text-color, #111); }\n                .empire-reply-body { font-size: 0.95em; color: var(--empire-body-color, #374151); }\n            </style>\n        \n                <div class="empire-split-layout">\n                    \x3c!-- LEFT SIDEBAR --\x3e\n                    <div class="empire-sidebar" id="empire-sidebar-${t}">\n                        <div class="empire-header-title">Customer Reviews</div>\n                        <div class="empire-header-subtitle">See what everyone is talking about.</div>\n                        <div id="empire-sidebar-stats-${t}"><div class="empire-big-rating">...</div></div>\n                        <button class="empire-write-btn" onclick="openWizard('${t}')">Write a Review</button>\n                    </div>\n\n                    \x3c!-- WIZARD OVERLAY (Psychological Design) --\x3e\n                    <div id="empire-wizard-${t}" class="empire-sidebar" style="display:none; text-align: center;">\n                         <div id="wizard-step-1-${t}" class="fade-in">\n                            <div style="font-size: 0.75rem; color: #9ca3af; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 0.5rem; font-weight: 600;">Step 1 of 2</div>\n                            <div class="empire-header-title" style="font-size: 2.5rem; text-align: center; margin-bottom: 0.5rem;">Rate this product</div>\n                            <div class="empire-header-subtitle" style="margin-bottom: 1rem;">It only takes a second to share.</div>\n                             <div class="empire-star-input" id="star-input-${t}">\n                                ${[1,2,3,4,5].map(e=>`<span onclick="setRating('${t}', ${e})" data-val="${e}">‚òÖ</span>`).join("")}\n                             </div>\n                             <button onclick="closeWizard('${t}')" style="position: absolute; bottom: 30px; left: 30px; background: none; border: none; color: #d1d5db; font-size: 0.8rem; cursor: pointer; padding: 10px; transition: color 0.2s;" onmouseover="this.style.color='#9ca3af'" onmouseout="this.style.color='#d1d5db'">Cancel</button>\n                             <input type="hidden" id="rating-val-${t}">\n                         </div>\n                         <div id="wizard-step-2-${t}" class="fade-in" style="display:none;">\n                            <div class="empire-header-title" style="font-size: 1.5rem;">Share your experience</div>\n                            <textarea id="review-body-${t}" class="empire-input" rows="4" placeholder="What did you like?"></textarea>\n                            <input id="review-name-${t}" class="empire-input" placeholder="Your Name" />\n                            <input id="review-email-${t}" class="empire-input" placeholder="Your Email" />\n                            <button class="empire-write-btn" onclick="submitReview('${t}', '${i}')">Submit Review</button>\n                            <button style="background:none; border:none; width:100%; margin-top:10px; cursor:pointer; color:#9ca3af;" onclick="closeWizard('${t}')">Cancel</button>\n                         </div>\n                         <div id="wizard-success-${t}" class="fade-in" style="display:none; text-align:center;">\n                            <div style="font-size: 3rem; margin-bottom: 1rem;">üéâ</div>\n                             <div class="empire-header-title" style="font-size: 1.5rem;">Thanks!</div>\n                             <p class="empire-header-subtitle">Your review has been submitted.</p>\n                             <button class="empire-write-btn" onclick="closeWizard('${t}')">Close</button>\n                         </div>\n                    </div>\n\n                    \x3c!-- RIGHT FEED --\x3e\n                    <div id="empire-feed-${t}" class="empire-feed">\n                        <div style="text-align:center; padding: 4rem; color: #9ca3af;">Loading reviews...</div>\n                    </div>\n                </div>\n            </div>\n        `;e.innerHTML=n;try{const n=await fetch(`${i}/api/reviews?productId=${t}`),r=await n.json();if(r.stats){const i=document.getElementById(`empire-sidebar-stats-${t}`),n={5:0,4:0,3:0,2:0,1:0};r.reviews.forEach(e=>n[e.rating]=(n[e.rating]||0)+1);const a=e.dataset.barColor||"#111111";i.innerHTML=`\n                    <div class="empire-big-rating">${r.stats.average.toFixed(1)}</div>\n                    <div class="empire-total-reviews">Based on ${r.stats.total} reviews</div>\n                    <div class="empire-bars">\n                        ${[5,4,3,2,1].map(e=>{const t=n[e]||0,i=r.stats.total||1;return`\n                            <div class="empire-bar-row">\n                                <div class="empire-bar-label">${e} ‚òÖ</div>\n                                <div class="empire-bar-bg">\n                                    <div class="empire-bar-fill" style="width: ${Math.round(t/i*100)}%; background-color: ${a} !important; height: 100% !important; display: block !important;"></div>\n                                </div>\n                                <div class="empire-bar-count">${t}</div>\n                            </div>\n                        `}).join("")}\n                    </div>\n                `}const a=document.getElementById(`empire-feed-${t}`);if(r.reviews&&r.reviews.length>0){const e=r.reviews.map(e=>`\n                    <div class="empire-review-card">\n                        <div class="card-header">\n                            <div class="reviewer-info">\n                                <div class="avatar">${(e.customerName||"A").charAt(0)}</div>\n                                <div>\n                                    <div class="username">${e.customerName||"Anonymous"}</div>\n                                    ${e.verified?'<div class="verified-badge">Available <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg> Verified Buyer</div>':""}\n                                </div>\n                            </div>\n                            <div class="review-date">${new Date(e.createdAt).toLocaleDateString()}</div>\n                        </div>\n                        <div class="stars-row">${"‚òÖ".repeat(e.rating)}${"‚òÜ".repeat(5-e.rating)}</div>\n                        <div class="review-body">${e.body||""}</div>\n                        \n                        ${e.replies&&e.replies.length>0?`\n                            <div class="empire-reply-box">\n                                <div class="empire-reply-header">\n                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg> \n                                    Store Owner\n                                </div>\n                                <div class="empire-reply-body">${e.replies[0].body}</div>\n                            </div>\n                        `:""}\n                    </div>\n                `).join("");let i;a.innerHTML=`<div id="feed-track-${t}">${e}${e}</div>`;const n=()=>{i=setInterval(()=>{a.scrollTop>=a.scrollHeight/2?a.scrollTop=0:a.scrollTop+=1},50)},o=()=>clearInterval(i);n(),a.addEventListener("mouseenter",o),a.addEventListener("mouseleave",n),a.addEventListener("touchstart",o)}else a.innerHTML='<div style="text-align:center; padding: 4rem;">Be the first to write a review!</div>'}catch(e){console.error("Empire API Error:",e)}}),window.openWizard=e=>{document.getElementById(`empire-sidebar-${e}`).style.display="none",document.getElementById(`empire-wizard-${e}`).style.display="flex"},window.closeWizard=e=>{document.getElementById(`empire-sidebar-${e}`).style.display="flex",document.getElementById(`empire-wizard-${e}`).style.display="none"},window.setRating=(e,t)=>{document.getElementById(`rating-val-${e}`).value=t;document.querySelectorAll(`#star-input-${e} span`).forEach((e,i)=>{e.className=i<t?"active":""}),setTimeout(()=>{document.getElementById(`wizard-step-1-${e}`).style.display="none",document.getElementById(`wizard-step-2-${e}`).style.display="block"},300)},window.submitReview=async(e,t)=>{const i=document.getElementById(`rating-val-${e}`).value,n=document.getElementById(`review-body-${e}`).value,r=document.getElementById(`review-name-${e}`).value,a=document.getElementById(`review-email-${e}`).value,o=new FormData;o.append("productId",e),o.append("rating",i),o.append("body",n),o.append("author",r),o.append("email",a);try{console.log(`Submitting to: ${t}/api/reviews`);const i=await fetch(`${t}/api/reviews`,{method:"POST",body:o});if(!i.ok){const e=await i.text();throw new Error(`Server responded with ${i.status}: ${e}`)}document.getElementById(`wizard-step-2-${e}`).style.display="none",document.getElementById(`wizard-success-${e}`).style.display="block"}catch(e){console.error(e),alert(`Error: ${e.message}. Check console for details.`)}}}function initStarRatings(){document.querySelectorAll(".empire-star-rating").forEach(async e=>{const t=e.dataset.productId;try{const i=await fetch(`/apps/empire-reviews/api/reviews?productId=${t}`),n=await i.json();if(n.stats&&n.stats.total>0){const t=Math.round(n.stats.average),i=n.stats.total,r=(e.dataset.starSize||24)+"px",a=(e.dataset.textSize||14)+"px",o="#fbbf24",s="#e5e7eb";let d="";for(let e=1;e<=5;e++){d+=`\n                        <svg viewBox="0 0 24 24" width="${r}" height="${r}" fill="${e<=t?o:s}">\n                            <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                        </svg>\n                    `}let l=e.dataset.countText||"({n} reviews)";l=l.replace("{n}",i);const p=e.dataset.textColor||"#6b7280";e.innerHTML=`\n                    <div style="display:flex; align-items:center; gap:4px;">\n                        <div style="display:flex; gap:1px;">${d}</div>\n                        ${"true"===e.dataset.showCount?`<span style="font-size: ${a}; margin-left: 4px; color: ${p}">${l}</span>`:""}\n                    </div>\n                `}else{const t=(e.dataset.starSize||24)+"px",i=(e.dataset.textSize||14)+"px",n="#e5e7eb";let r="";for(let e=1;e<=5;e++)r+=`\n                        <svg viewBox="0 0 24 24" width="${t}" height="${t}" fill="${n}">\n                            <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                        </svg>\n                    `;const a=e.dataset.textColor||"#6b7280";e.innerHTML=`\n                    <div style="display:flex; align-items:center; gap:4px;">\n                        <div style="display:flex; gap:1px;">${r}</div>\n                         ${"true"===e.dataset.showCount?`<span style="font-size: ${i}; margin-left: 4px; color: ${a}">No reviews yet</span>`:""}\n                    </div>\n                `}}catch(e){console.error("Empire Star Rating Error:",e)}})}document.addEventListener("DOMContentLoaded",()=>{window.empireV2Initialized||(window.empireV2Initialized=!0,initReviewWidgets(),initStarRatings(),initCarousel(),initFloatingTab(),initMediaGrid())});